# 设备信息功能测试文档

## 功能概述

配置页面新增了以下设备信息功能：

1. **MAC地址显示**：自动读取并显示当前设备的MAC地址
2. **摄像头设备列表**：显示所有可用的摄像头设备
3. **摄像头切换**：支持在多摄像头之间切换
4. **摄像头重新初始化**：切换后自动重新初始化摄像头

## 测试步骤

### 1. MAC地址功能测试

#### 测试步骤：
1. 启动应用
2. 进入配置页面
3. 查看"设备信息"部分
4. 验证MAC地址是否正确显示
5. 点击"刷新"按钮测试刷新功能

#### 预期结果：
- MAC地址应该正确显示（格式如：XX:XX:XX:XX:XX:XX）
- 刷新按钮应该能重新获取MAC地址
- 如果获取失败，应显示相应的错误信息

### 2. 摄像头设备列表测试

#### 测试步骤：
1. 进入配置页面
2. 查看"摄像头设备"下拉框
3. 验证是否显示了所有可用的摄像头设备
4. 点击"刷新摄像头列表"按钮

#### 预期结果：
- 下拉框应显示所有可用的摄像头设备
- 设备名称应清晰可读（如：摄像头 1、摄像头 2 或具体设备名称）
- 刷新按钮应能重新扫描设备列表

### 3. 摄像头切换功能测试

#### 测试步骤：
1. 确保有多个摄像头设备
2. 在配置页面选择一个不同的摄像头
3. 点击"切换摄像头"按钮
4. 进入拍照页面验证摄像头是否已切换

#### 预期结果：
- 切换成功后应显示"摄像头切换成功"消息
- 拍照页面应使用新选择的摄像头
- 摄像头画面应正常显示

### 4. 多摄像头场景测试

#### 测试场景：
- 内置摄像头 + 外接USB摄像头
- 多个USB摄像头
- 虚拟摄像头（如OBS虚拟摄像头）

#### 测试步骤：
1. 连接多个摄像头设备
2. 进入配置页面
3. 验证所有设备都出现在列表中
4. 逐个测试每个摄像头的切换功能

## 技术实现细节

### MAC地址获取
```javascript
// 主进程 (main.js)
ipcMain.handle('get-mac-address', () => {
  const networkInterfaces = os.networkInterfaces();
  // 遍历网络接口获取MAC地址
});

// 渲染进程 (renderer/app.js)
const macAddress = await ipcRenderer.invoke('get-mac-address');
```

### 摄像头设备枚举
```javascript
// 获取所有媒体设备
const devices = await navigator.mediaDevices.enumerateDevices();
const videoDevices = devices.filter(device => device.kind === 'videoinput');
```

### 摄像头切换
```javascript
// 停止当前流
cameraStream.getTracks().forEach(track => track.stop());

// 请求新摄像头
const constraints = {
  video: {
    deviceId: { exact: selectedDeviceId },
    width: { ideal: 1920 },
    height: { ideal: 1080 }
  }
};
cameraStream = await navigator.mediaDevices.getUserMedia(constraints);
```

## 错误处理

### MAC地址获取失败
- 显示"获取失败: [错误信息]"
- 提供刷新按钮重新尝试

### 摄像头设备枚举失败
- 显示"获取设备列表失败: [错误信息]"
- 提供刷新按钮重新扫描

### 摄像头切换失败
- 显示"切换摄像头失败: [错误信息]"
- 保持当前摄像头状态

## 调试信息

控制台会输出详细的调试信息：
- `🔍 初始化设备信息...`
- `✅ MAC地址加载成功: [MAC地址]`
- `📹 找到摄像头设备: [设备列表]`
- `🔄 切换摄像头到设备: [设备ID]`
- `✅ 摄像头重新初始化成功`

## 注意事项

1. **权限要求**：摄像头功能需要用户授权
2. **设备兼容性**：某些虚拟摄像头可能无法正常工作
3. **性能考虑**：频繁切换摄像头可能影响性能
4. **错误恢复**：如果切换失败，应恢复到之前的工作状态

## 测试用例

### 用例1：单摄像头设备
- 预期：MAC地址正常显示，摄像头列表只有一个选项
- 切换：无切换选项或切换无效

### 用例2：多摄像头设备
- 预期：MAC地址正常显示，摄像头列表有多个选项
- 切换：可以正常切换并重新初始化

### 用例3：无摄像头设备
- 预期：MAC地址正常显示，摄像头列表显示"未找到摄像头设备"
- 切换：切换按钮无效

### 用例4：权限被拒绝
- 预期：MAC地址正常显示，摄像头列表显示权限错误
- 切换：切换按钮无效，需要重新授权
